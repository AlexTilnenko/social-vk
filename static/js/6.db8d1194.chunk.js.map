{"version":3,"sources":["components/common/Pagination/NavButton.jsx","components/common/Pagination/Pagination.jsx","selectors/usersSelectors.js","components/Users/User.jsx","components/Users/Users.jsx","actions/users.js"],"names":["NavButton","handler","disabledTrigger","icoId","className","onClick","disabled","href","sprite","Pagination","React","memo","pagesCount","currentPage","onPageChange","isLoading","visiblePartSize","useState","visiblePartNumber","setVisiblePartNumber","pages","i","push","visiblePartsCount","Math","ceil","leftBorder","rightBorder","filter","page","map","key","classNames","active","length","initialValues","onSubmit","values","resetForm","currentPartNumber","goToPageHandler","type","name","value","selectUserPagesCount","createSelector","state","users","totalUsersCount","pageSize","selectUsersData","User","id","photos","followed","followingInProgress","onClickUnfollow","onClickFollow","to","src","large","photoHolder","alt","some","item","compose","withAuthRedirect","dispatch","useDispatch","useSelector","items","useEffect","fetchUsers","fetchFollow","fetchUnfollow","Loader","setCurrentPage","visiblePagesSize","SET_CURRENT_PAGE","payload","setFollowingProgress","data","SET_FOLLOWING","toggleFollow","TOGGLE_FOLLOW_USER","a","SET_LOADING","usersApi","getUsers","resp","usersData","SET_USERS","followUnfollowFlow","apiMethod","resultCode","isFetching","followUser","unfollowUser"],"mappings":"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","file":"static/js/6.db8d1194.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nimport sprite from '../../../assets/img/sprite.svg';\r\n\r\nfunction NavButton({ handler, disabledTrigger, icoId }) {\r\n   return (\r\n      <button className=\"pagination__btn-item pagination__block\" onClick={handler} disabled={disabledTrigger}>\r\n         <svg className=\"pagination__btn-ico\">\r\n            <use href={sprite + icoId} />\r\n         </svg>\r\n      </button>\r\n   );\r\n}\r\n\r\nexport default NavButton;\r\n","import React, { useState } from 'react';\r\nimport classNames from 'classnames';\r\nimport { Formik, Field, Form } from 'formik';\r\nimport NavButton from './NavButton';\r\n\r\nconst Pagination = React.memo(function Pagination({\r\n   pagesCount,\r\n   currentPage,\r\n   onPageChange,\r\n   isLoading,\r\n   visiblePartSize = 10,\r\n}) {\r\n   const [visiblePartNumber, setVisiblePartNumber] = useState(1);\r\n\r\n   const pages = [];\r\n   for (let i = 1; i <= pagesCount; i++) {\r\n      pages.push(i);\r\n   }\r\n   const visiblePartsCount = Math.ceil(pagesCount / visiblePartSize);\r\n   const leftBorder = (visiblePartNumber - 1) * visiblePartSize + 1;\r\n   const rightBorder = visiblePartNumber * visiblePartSize;\r\n\r\n   const nextPageHandler = () => {\r\n      if (currentPage >= rightBorder) {\r\n         setVisiblePartNumber(visiblePartNumber + 1);\r\n      }\r\n      onPageChange(currentPage + 1);\r\n   };\r\n\r\n   const prevPageHandler = () => {\r\n      if (currentPage <= leftBorder) {\r\n         setVisiblePartNumber(visiblePartNumber - 1);\r\n      }\r\n      onPageChange(currentPage - 1);\r\n   };\r\n\r\n   const toEndHandler = () => {\r\n      setVisiblePartNumber(visiblePartsCount);\r\n      onPageChange((visiblePartsCount - 1) * visiblePartSize + 1);\r\n   };\r\n\r\n   const toStartHandler = () => {\r\n      setVisiblePartNumber(1);\r\n      onPageChange(1);\r\n   };\r\n\r\n   const goToPageHandler = ({ currentPage }, { resetForm }) => {\r\n      const currentPartNumber = Math.ceil(currentPage / visiblePartSize);\r\n      if (currentPage >= 1 && currentPartNumber <= visiblePartsCount) {\r\n         setVisiblePartNumber(currentPartNumber);\r\n         onPageChange(currentPage);\r\n         resetForm();\r\n      }\r\n   };\r\n\r\n   return (\r\n      <ul className=\"pagination\">\r\n         <div className=\"pagination__btn-group\">\r\n            {visiblePartNumber > 1 && (\r\n               <NavButton handler={toStartHandler} disabledTrigger={isLoading} icoId=\"#double-arrow\" />\r\n            )}\r\n            {currentPage > 1 && <NavButton handler={prevPageHandler} disabledTrigger={isLoading} icoId=\"#arrow\" />}\r\n         </div>\r\n         {pages\r\n            .filter((page) => page >= leftBorder && page <= rightBorder)\r\n            .map((page) => {\r\n               return (\r\n                  <li\r\n                     key={page}\r\n                     className={classNames('pagination__item', 'pagination__block', {\r\n                        active: currentPage === page,\r\n                     })}\r\n                     onClick={() => onPageChange(page)}\r\n                  >\r\n                     {page}\r\n                  </li>\r\n               );\r\n            })}\r\n         <div className=\"pagination__btn-group\">\r\n            {visiblePartsCount > visiblePartNumber && (\r\n               <NavButton handler={toEndHandler} disabledTrigger={isLoading} icoId=\"#double-arrow\" />\r\n            )}\r\n            {currentPage < pagesCount && (\r\n               <NavButton handler={nextPageHandler} disabledTrigger={isLoading} icoId=\"#arrow\" />\r\n            )}\r\n         </div>\r\n         {pages.length > 10 && (\r\n            <Formik\r\n               initialValues={{\r\n                  currentPage: '',\r\n               }}\r\n               onSubmit={(values, { resetForm }) => goToPageHandler(values, { resetForm })}\r\n            >\r\n               {({ values }) => (\r\n                  <Form className=\"pagination__form\">\r\n                     <Field\r\n                        type=\"number\"\r\n                        name=\"currentPage\"\r\n                        className=\"pagination__form-input\"\r\n                        value={values.currentPage}\r\n                     />\r\n                     <button className=\"pagination__form-btn\" disabled={isLoading} type=\"submit\">\r\n                        Перейти\r\n                     </button>\r\n                  </Form>\r\n               )}\r\n            </Formik>\r\n         )}\r\n      </ul>\r\n   );\r\n});\r\n\r\nexport default Pagination;\r\n","import { createSelector } from 'reselect';\r\n\r\nexport const selectUserPagesCount = createSelector(\r\n   (state) => state.users, \r\n   ({totalUsersCount, pageSize}) => Math.ceil(totalUsersCount / pageSize)\r\n   );\r\nexport const selectUsersData = (state) => state.users;\r\n","import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport classNames from 'classnames';\r\n\r\nimport photoHolder from '../../assets/img/user.png';\r\n\r\nconst User = React.memo(function User({\r\n   id,\r\n   name,\r\n   photos,\r\n   followed,\r\n   followingInProgress,\r\n   onClickUnfollow,\r\n   onClickFollow,\r\n}) {\r\n   return (\r\n      <li className=\"users__item block\" key={id}>\r\n         <Link to={`/profile/${id}`}>\r\n            <span className=\"users__item-photo avatar\">\r\n               <img src={photos.large || photoHolder} alt={name} />\r\n            </span>\r\n            <span className=\"users__item-name\">{name}</span>\r\n         </Link>\r\n         <button\r\n            className={classNames('btn', { 'btn--unfollow': followed, 'btn--follow': !followed })}\r\n            onClick={followed ? () => onClickUnfollow(id) : () => onClickFollow(id)}\r\n            disabled={followingInProgress.some((item) => item === id)}\r\n         >\r\n            {followed ? 'Вы подписаны' : 'Подписаться'}\r\n         </button>\r\n      </li>\r\n   );\r\n});\r\n\r\nexport default User;\r\n","import React, { useEffect } from 'react';\r\nimport { compose } from 'redux';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport withAuthRedirect from '../hoc/withAuthRedirect';\r\nimport Loader from '../common/Loader/Loader';\r\nimport { fetchUsers, setCurrentPage, fetchFollow, fetchUnfollow } from '../../actions/users';\r\nimport { selectUserPagesCount, selectUsersData } from '../../selectors/usersSelectors';\r\nimport Pagination from '../common/Pagination/Pagination';\r\nimport User from './User';\r\n\r\nfunction Users() {\r\n   const dispatch = useDispatch();\r\n   const { items, pageSize, currentPage, isLoading, followingInProgress } = useSelector(selectUsersData);\r\n   const pagesCount = useSelector(selectUserPagesCount);\r\n   useEffect(() => {\r\n      dispatch(fetchUsers(currentPage, pageSize));\r\n   }, [currentPage]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n   const onPageChange = (page) => {\r\n      dispatch(setCurrentPage(page));\r\n   };\r\n\r\n   const onClickFollow = (id) => {\r\n      dispatch(fetchFollow(id));\r\n   };\r\n   const onClickUnfollow = (id) => {\r\n      dispatch(fetchUnfollow(id));\r\n   };\r\n\r\n   return (\r\n      <div className=\"users\">\r\n         {isLoading && <Loader />}\r\n         <Pagination\r\n            pagesCount={pagesCount}\r\n            currentPage={currentPage}\r\n            onPageChange={onPageChange}\r\n            isLoading={isLoading}\r\n            visiblePagesSize={10}\r\n         />\r\n         <ul className=\"users__list\">\r\n            {items.map(({ id, name, followed, photos }) => {\r\n               return (\r\n                  <User\r\n                     key={id}\r\n                     id={id}\r\n                     name={name}\r\n                     photos={photos}\r\n                     followed={followed}\r\n                     followingInProgress={followingInProgress}\r\n                     onClickUnfollow={onClickUnfollow}\r\n                     onClickFollow={onClickFollow}\r\n                  />\r\n               );\r\n            })}\r\n         </ul>\r\n      </div>\r\n   );\r\n}\r\n\r\nexport default compose(withAuthRedirect)(Users);\r\n","import { usersApi } from '../api/api';\r\n\r\nimport { SET_USERS, SET_CURRENT_PAGE, SET_LOADING, TOGGLE_FOLLOW_USER, SET_FOLLOWING } from './types';\r\n\r\nexport const setUsers = (usersData) => ({\r\n   type: SET_USERS,\r\n   payload: usersData,\r\n});\r\n\r\nexport const setCurrentPage = (page) => ({\r\n   type: SET_CURRENT_PAGE,\r\n   payload: page,\r\n});\r\n\r\nexport const setLoadingProgress = () => ({\r\n   type: SET_LOADING,\r\n});\r\n\r\nexport const setFollowingProgress = (data) => ({\r\n   type: SET_FOLLOWING,\r\n   payload: data,\r\n});\r\n\r\nexport const toggleFollow = (id) => ({\r\n   type: TOGGLE_FOLLOW_USER,\r\n   payload: id,\r\n});\r\n\r\nexport const fetchUsers = (currentPage, pageSize) => async (dispatch) => {\r\n   dispatch(setLoadingProgress());\r\n   const resp = await usersApi.getUsers(currentPage, pageSize);\r\n   dispatch(setUsers(resp));\r\n};\r\n\r\nconst followUnfollowFlow = async (dispatch, id, apiMethod) => {\r\n   const resp = await apiMethod(id);\r\n   if (resp.resultCode === 0) {\r\n      dispatch(toggleFollow(id));\r\n   }\r\n};\r\n\r\nexport const fetchFollow = (id) => async (dispatch) => {\r\n   dispatch(setFollowingProgress({ isFetching: true, id }));\r\n   followUnfollowFlow(dispatch, id, usersApi.followUser);\r\n};\r\n\r\nexport const fetchUnfollow = (id) => async (dispatch) => {\r\n   dispatch(setFollowingProgress({ isFetching: true, id }));\r\n   followUnfollowFlow(dispatch, id, usersApi.unfollowUser);\r\n};\r\n"],"sourceRoot":""}